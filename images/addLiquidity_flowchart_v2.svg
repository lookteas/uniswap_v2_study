<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1700">
  <defs>
    <!-- æ¸å˜å®šä¹‰ -->
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="processGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="decisionGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fa709a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fee140;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="successGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#11998e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38ef7d;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="errorGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#eb3349;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f45c43;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="internalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6a11cb;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2575fc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ee5a24;stop-opacity:1" />
    </linearGradient>
    
    <!-- é˜´å½±æ•ˆæœ -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    
    <!-- ç®­å¤´æ ‡è®° -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#38ef7d"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f45c43"/>
    </marker>
  </defs>
  
  <!-- èƒŒæ™¯ -->
  <rect width="1200" height="1700" fill="#f8fafc"/>
  
  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <rect x="50" y="20" width="1100" height="80" rx="15" fill="url(#headerGrad)" filter="url(#shadow)"/>
  <text x="600" y="55" text-anchor="middle" fill="white" font-size="28" font-weight="bold" font-family="Arial, sans-serif">
    UniswapV2 addLiquidity() å®Œæ•´æµç¨‹å›¾
  </text>
  <text x="600" y="82" text-anchor="middle" fill="white" font-size="14" font-family="Arial, sans-serif">
    åŒ…å«æ»‘ç‚¹ä¿æŠ¤æœºåˆ¶ | æºç : UniswapV2Router02.sol ç¬¬ 61-76 è¡Œ | å¸¦æ‰§è¡Œåºå·
  </text>
  
  <!-- ==================== Step 1: ç”¨æˆ·è°ƒç”¨å…¥å£ ==================== -->
  <g transform="translate(400, 130)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="20" cy="30" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="20" y="36" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">1</text>
    
    <!-- å¼€å§‹èŠ‚ç‚¹ -->
    <ellipse cx="220" cy="30" rx="180" ry="35" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="220" y="25" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">
      ç”¨æˆ·è°ƒç”¨ addLiquidity()
    </text>
    <text x="220" y="42" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      ä¼ å…¥: tokenA, tokenB, amountADesired, amountBDesired
    </text>
  </g>
  
  <!-- å‚æ•°è¯´æ˜æ¡† -->
  <g transform="translate(820, 115)">
    <rect x="0" y="0" width="320" height="100" rx="8" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
    <text x="160" y="20" text-anchor="middle" fill="#856404" font-size="12" font-weight="bold" font-family="Arial, sans-serif">ğŸ“‹ å…³é”®å‚æ•°è¯´æ˜</text>
    <text x="10" y="40" fill="#856404" font-size="11" font-family="Arial, sans-serif">â€¢ amountAMin / amountBMin: æœ€å°æ¥å—é‡(æ»‘ç‚¹ä¸‹é™)</text>
    <text x="10" y="57" fill="#856404" font-size="11" font-family="Arial, sans-serif">â€¢ deadline: äº¤æ˜“æˆªæ­¢æ—¶é—´æˆ³(é˜²MEVå»¶è¿Ÿ)</text>
    <text x="10" y="74" fill="#856404" font-size="11" font-family="Arial, sans-serif">â€¢ to: LP Token æ¥æ”¶åœ°å€</text>
    <text x="10" y="91" fill="#856404" font-size="11" font-family="Arial, sans-serif">â€¢ amountDesired: æœŸæœ›å­˜å…¥é‡(æ»‘ç‚¹ä¸Šé™)</text>
  </g>
  
  <!-- ç®­å¤´: ç”¨æˆ·è°ƒç”¨ â†’ deadlineæ£€æŸ¥ -->
  <line x1="620" y1="195" x2="620" y2="230" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ==================== Step 2: deadline æ£€æŸ¥ ==================== -->
  <g transform="translate(400, 240)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="50" cy="50" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="50" y="56" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">2</text>
    
    <polygon points="220,0 370,50 220,100 70,50" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="220" y="42" text-anchor="middle" fill="white" font-size="13" font-weight="bold" font-family="Arial, sans-serif">
      ensure(deadline)
    </text>
    <text x="220" y="58" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      deadline â‰¥ block.timestamp ?
    </text>
  </g>
  
  <!-- deadline æ£€æŸ¥æ³¨é‡Š -->
  <g transform="translate(50, 250)">
    <rect x="0" y="0" width="280" height="70" rx="8" fill="#e8f4fd" stroke="#0288d1" stroke-width="1.5"/>
    <text x="140" y="18" text-anchor="middle" fill="#01579b" font-size="11" font-weight="bold" font-family="Arial, sans-serif">ğŸ›¡ï¸ ç¬¬ä¸€é“é˜²çº¿: æ—¶é—´ä¿æŠ¤</text>
    <text x="10" y="35" fill="#01579b" font-size="10" font-family="Arial, sans-serif">â€¢ é˜²æ­¢äº¤æ˜“è¢«çŸ¿å·¥æ— é™å»¶è¿Ÿæ‰§è¡Œ</text>
    <text x="10" y="50" fill="#01579b" font-size="10" font-family="Arial, sans-serif">â€¢ å…¸å‹è®¾ç½®: å½“å‰æ—¶é—´ + 20åˆ†é’Ÿ</text>
    <text x="10" y="65" fill="#01579b" font-size="10" font-family="Arial, sans-serif">â€¢ æºç ä½ç½®: Router02.sol ç¬¬ 18-21 è¡Œ</text>
  </g>
  
  <!-- deadline å¤±è´¥è·¯å¾„ -->
  <line x1="770" y1="290" x2="870" y2="290" stroke="#f45c43" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="820" y="280" text-anchor="middle" fill="#f45c43" font-size="12" font-weight="bold" font-family="Arial, sans-serif">å¦</text>
  
  <g transform="translate(880, 260)">
    <rect x="0" y="0" width="200" height="60" rx="10" fill="url(#errorGrad)" filter="url(#shadow)"/>
    <text x="100" y="25" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">âŒ äº¤æ˜“å›æ»š</text>
    <text x="100" y="45" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">'UniswapV2Router: EXPIRED'</text>
  </g>
  
  <!-- deadline æˆåŠŸè·¯å¾„ -->
  <line x1="620" y1="340" x2="620" y2="380" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="640" y="365" fill="#38ef7d" font-size="12" font-weight="bold" font-family="Arial, sans-serif">æ˜¯ âœ“</text>
  
  <!-- ==================== Step 3: è°ƒç”¨ _addLiquidity ==================== -->
  <g transform="translate(400, 390)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="25" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="31" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">3</text>
    
    <rect x="20" y="0" width="400" height="50" rx="10" fill="url(#internalGrad)" filter="url(#shadow)"/>
    <text x="220" y="22" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">
      è°ƒç”¨å†…éƒ¨å‡½æ•° _addLiquidity()
    </text>
    <text x="220" y="40" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      è®¡ç®—æœ€ä¼˜å­˜å…¥æ•°é‡ | æºç : ç¬¬ 33-60 è¡Œ
    </text>
  </g>
  
  <!-- ç®­å¤´ -->
  <line x1="620" y1="440" x2="620" y2="480" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ==================== Step 4: Pair å­˜åœ¨æ£€æŸ¥ ==================== -->
  <g transform="translate(400, 490)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="50" cy="69" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="50" y="73" text-anchor="middle" fill="white" font-size="17" font-weight="bold" font-family="Arial, sans-serif">4</text>
    
    <polygon points="220,0 370,50 220,100 70,50" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="220" y="42" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      getPair(tokenA, tokenB)
    </text>
    <text x="220" y="58" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      == address(0) ?
    </text>
  </g>
  
  <!-- Pair ä¸å­˜åœ¨ - åˆ›å»º (Step 4a) -->
  <line x1="470" y1="540" x2="300" y2="540" stroke="#555" stroke-width="2"/>
  <line x1="300" y1="540" x2="300" y2="580" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="380" y="530" fill="#555" font-size="12" font-weight="bold" font-family="Arial, sans-serif">æ˜¯(Pairä¸å­˜åœ¨)</text>
  
  <g transform="translate(130, 590)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="25" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="30" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="Arial, sans-serif">4a</text>
    
    <rect x="20" y="0" width="300" height="50" rx="10" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="170" y="22" text-anchor="middle" fill="white" font-size="13" font-weight="bold" font-family="Arial, sans-serif">
      Factory.createPair(tokenA, tokenB)
    </text>
    <text x="170" y="40" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">
      ä½¿ç”¨ CREATE2 éƒ¨ç½²æ–°çš„ Pair åˆçº¦
    </text>
  </g>
  
  <!-- åˆ›å»ºåè¿æ¥åˆ°è·å–å‚¨å¤‡ -->
  <line x1="300" y1="640" x2="300" y2="680" stroke="#555" stroke-width="2"/>
  <line x1="300" y1="680" x2="620" y2="680" stroke="#555" stroke-width="2"/>
  <line x1="620" y1="680" x2="620" y2="720" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Pair å­˜åœ¨ -->
  <line x1="770" y1="540" x2="870" y2="540" stroke="#555" stroke-width="2"/>
  <line x1="870" y1="540" x2="870" y2="680" stroke="#555" stroke-width="2"/>
  <line x1="870" y1="680" x2="620" y2="680" stroke="#555" stroke-width="2"/>
  <text x="820" y="530" fill="#555" font-size="12" font-weight="bold" font-family="Arial, sans-serif">å¦(å·²å­˜åœ¨)</text>
  
  <!-- ==================== Step 5: è·å–å‚¨å¤‡é‡ ==================== -->
  <g transform="translate(400, 730)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="25" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="31" text-anchor="middle" fill="white" font-size="17" font-weight="bold" font-family="Arial, sans-serif">5</text>
    
    <rect x="20" y="0" width="400" height="50" rx="10" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="220" y="22" text-anchor="middle" fill="white" font-size="13" font-weight="bold" font-family="Arial, sans-serif">
      getReserves(factory, tokenA, tokenB)
    </text>
    <text x="220" y="40" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      è·å–å½“å‰æ± å­å‚¨å¤‡é‡ reserveA, reserveB
    </text>
  </g>
  
  <!-- ç®­å¤´ -->
  <line x1="620" y1="780" x2="620" y2="820" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ==================== Step 6: å‚¨å¤‡é‡åˆ¤æ–­ ==================== -->
  <g transform="translate(400, 830)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="50" cy="73" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="50" y="77" text-anchor="middle" fill="white" font-size="17" font-weight="bold" font-family="Arial, sans-serif">6</text>
    
    <polygon points="220,0 370,50 220,100 70,50" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="220" y="42" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      reserveA == 0 &amp;&amp;
    </text>
    <text x="220" y="58" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      reserveB == 0 ?
    </text>
  </g>
  
  <!-- é¦–æ¬¡æ·»åŠ æµåŠ¨æ€§ (Step 6a) -->
  <line x1="470" y1="880" x2="220" y2="880" stroke="#38ef7d" stroke-width="2"/>
  <line x1="220" y1="880" x2="220" y2="940" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="340" y="870" fill="#38ef7d" font-size="12" font-weight="bold" font-family="Arial, sans-serif">æ˜¯(é¦–æ¬¡æ·»åŠ )</text>
  
  <g transform="translate(50, 950)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="35" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="40" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">6a</text>
    
    <rect x="20" y="0" width="300" height="70" rx="10" fill="url(#successGrad)" filter="url(#shadow)"/>
    <text x="170" y="22" text-anchor="middle" fill="white" font-size="13" font-weight="bold" font-family="Arial, sans-serif">
      âœ… ç›´æ¥ä½¿ç”¨æœŸæœ›å€¼
    </text>
    <text x="170" y="42" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      amountA = amountADesired
    </text>
    <text x="170" y="58" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">
      amountB = amountBDesired
    </text>
  </g>
  
  <!-- é¦–æ¬¡æ·»åŠ æ³¨é‡Š -->
  <g transform="translate(50, 1030)">
    <rect x="0" y="0" width="320" height="50" rx="8" fill="#d4edda" stroke="#28a745" stroke-width="1.5"/>
    <text x="160" y="18" text-anchor="middle" fill="#155724" font-size="10" font-weight="bold" font-family="Arial, sans-serif">ğŸ’¡ é¦–æ¬¡æ·»åŠ æ— æ»‘ç‚¹é—®é¢˜</text>
    <text x="10" y="35" fill="#155724" font-size="9" font-family="Arial, sans-serif">ç”¨æˆ·è‡ªå®šä¹‰åˆå§‹ä»·æ ¼æ¯”ä¾‹ï¼Œæ— éœ€ä¿æŠ¤</text>
    <text x="10" y="47" fill="#155724" font-size="9" font-family="Arial, sans-serif">æ³¨æ„: é¦–æ¬¡LPä¼šé”å®š MINIMUM_LIQUIDITY (1000)</text>
  </g>
  
  <!-- éé¦–æ¬¡æ·»åŠ  (Step 7) -->
  <line x1="770" y1="880" x2="970" y2="880" stroke="#555" stroke-width="2"/>
  <line x1="970" y1="880" x2="970" y2="940" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="870" y="870" fill="#555" font-size="12" font-weight="bold" font-family="Arial, sans-serif">å¦(å·²æœ‰æµåŠ¨æ€§)</text>
  
  <!-- ==================== Step 7: è®¡ç®—æœ€ä¼˜Bæ•°é‡ ==================== -->
  <g transform="translate(750, 950)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="30" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="36" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">7</text>
    
    <rect x="20" y="0" width="350" height="60" rx="10" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="195" y="22" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      è®¡ç®— amountBOptimal
    </text>
    <text x="195" y="40" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">
      = quote(amountADesired, reserveA, reserveB)
    </text>
    <text x="195" y="55" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">
      = amountADesired Ã— reserveB / reserveA
    </text>
  </g>
  
  <!-- quote å…¬å¼æ³¨é‡Š -->
  <g transform="translate(770, 1020)">
    <rect x="0" y="0" width="350" height="45" rx="8" fill="#e8f4fd" stroke="#0288d1" stroke-width="1.5"/>
    <text x="175" y="16" text-anchor="middle" fill="#01579b" font-size="10" font-weight="bold" font-family="Arial, sans-serif">ğŸ“ quote() å‡½æ•°è¯´æ˜</text>
    <text x="10" y="32" fill="#01579b" font-size="9" font-family="Arial, sans-serif">æŒ‰å½“å‰ä»·æ ¼æ¯”ä¾‹è®¡ç®—ç­‰ä»·æ•°é‡ï¼Œæ— æ‰‹ç»­è´¹æ‰£é™¤</text>
    <text x="10" y="43" fill="#01579b" font-size="9" font-family="Arial, sans-serif">æºç : UniswapV2Library.sol ç¬¬ 36-40 è¡Œ</text>
  </g>
  
  <!-- ç®­å¤´ -->
  <line x1="945" y1="1065" x2="945" y2="1100" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ==================== Step 8: BOptimal æ¯”è¾ƒ ==================== -->
  <g transform="translate(725, 1110)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="70" cy="30" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="70" y="36" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">8</text>
    
    <polygon points="220,0 370,50 220,100 90,50" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="230" y="42" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      amountBOptimal â‰¤
    </text>
    <text x="230" y="58" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">
      amountBDesired ?
    </text>
  </g>
  
  <!-- BOptimal <= BDesired (ç”¨æˆ·æ„¿æ„æ¥å—) - Step 9a -->
  <line x1="815" y1="1160" x2="520" y2="1160" stroke="#38ef7d" stroke-width="2"/>
  <line x1="520" y1="1160" x2="520" y2="1210" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="660" y="1150" fill="#38ef7d" font-size="11" font-weight="bold" font-family="Arial, sans-serif">æ˜¯ âœ“</text>
  
  <!-- æ»‘ç‚¹æ£€æŸ¥ B (Step 9a) -->
  <g transform="translate(300, 1220)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="80" cy="27" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="80" y="33" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">9a</text>
    
    <polygon points="220,0 340,45 220,90 100,45" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="220" y="38" text-anchor="middle" fill="white" font-size="11" font-weight="bold" font-family="Arial, sans-serif">
      amountBOptimal â‰¥
    </text>
    <text x="220" y="55" text-anchor="middle" fill="white" font-size="11" font-weight="bold" font-family="Arial, sans-serif">
      amountBMin ?
    </text>
  </g>
  
  <!-- æ»‘ç‚¹æ£€æŸ¥ B æ³¨é‡Š -->
  <g transform="translate(50, 1220)">
    <rect x="0" y="0" width="220" height="70" rx="8" fill="#fff3cd" stroke="#ffc107" stroke-width="1.5"/>
    <text x="110" y="18" text-anchor="middle" fill="#856404" font-size="10" font-weight="bold" font-family="Arial, sans-serif">ğŸ›¡ï¸ ç¬¬äºŒé“é˜²çº¿: æ»‘ç‚¹ä¿æŠ¤B</text>
    <text x="10" y="35" fill="#856404" font-size="9" font-family="Arial, sans-serif">ç¡®ä¿å®é™…å­˜å…¥çš„ B æ•°é‡</text>
    <text x="10" y="48" fill="#856404" font-size="9" font-family="Arial, sans-serif">ä¸ä½äºç”¨æˆ·è®¾å®šçš„æœ€å°å€¼</text>
    <text x="10" y="61" fill="#856404" font-size="9" font-family="Arial, sans-serif">æºç : ç¬¬ 51 è¡Œ</text>
  </g>
  
  <!-- B æ»‘ç‚¹æ£€æŸ¥å¤±è´¥ -->
  <line x1="400" y1="1265" x2="300" y2="1265" stroke="#f45c43" stroke-width="2"/>
  <line x1="300" y1="1265" x2="300" y2="1320" stroke="#f45c43" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="340" y="1290" fill="#f45c43" font-size="10" font-weight="bold" font-family="Arial, sans-serif">å¦</text>
  
  <g transform="translate(150, 1330)">
    <rect x="0" y="0" width="300" height="50" rx="10" fill="url(#errorGrad)" filter="url(#shadow)"/>
    <text x="150" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold" font-family="Arial, sans-serif">âŒ äº¤æ˜“å›æ»š</text>
    <text x="150" y="40" text-anchor="middle" fill="white" font-size="9" font-family="Arial, sans-serif">'UniswapV2Router: INSUFFICIENT_B_AMOUNT'</text>
  </g>
  
  <!-- B æ»‘ç‚¹æ£€æŸ¥æˆåŠŸ - Step 10a -->
  <line x1="640" y1="1265" x2="720" y2="1265" stroke="#38ef7d" stroke-width="2"/>
  <text x="680" y="1255" fill="#38ef7d" font-size="10" font-weight="bold" font-family="Arial, sans-serif">æ˜¯ âœ“</text>
  
  <g transform="translate(730, 1235)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="30" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="35" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">10a</text>
    
    <rect x="20" y="0" width="200" height="60" rx="10" fill="url(#successGrad)" filter="url(#shadow)"/>
    <text x="120" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold" font-family="Arial, sans-serif">âœ… æ–¹æ¡ˆä¸€ç¡®å®š</text>
    <text x="120" y="40" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">amountA = amountADesired</text>
    <text x="120" y="55" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">amountB = amountBOptimal</text>
  </g>
  
  <!-- BOptimal > BDesired (éœ€è¦åå‘è®¡ç®—) - Step 9b -->
  <line x1="1095" y1="1160" x2="1140" y2="1160" stroke="#555" stroke-width="2"/>
  <line x1="1140" y1="1160" x2="1140" y2="1210" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="1120" y="1150" fill="#555" font-size="11" font-weight="bold" font-family="Arial, sans-serif">å¦</text>
  
  <!-- è®¡ç®— AOptimal (Step 9b) -->
  <g transform="translate(990, 1220)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="27" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="32" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">9b</text>
    
    <rect x="20" y="0" width="180" height="55" rx="10" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="110" y="18" text-anchor="middle" fill="white" font-size="10" font-weight="bold" font-family="Arial, sans-serif">è®¡ç®— amountAOptimal</text>
    <text x="110" y="35" text-anchor="middle" fill="white" font-size="9" font-family="Arial, sans-serif">= quote(amountBDesired,</text>
    <text x="110" y="48" text-anchor="middle" fill="white" font-size="9" font-family="Arial, sans-serif">reserveB, reserveA)</text>
  </g>
  
  <!-- ç®­å¤´åˆ° A æ»‘ç‚¹æ£€æŸ¥ -->
  <line x1="1100" y1="1275" x2="1100" y2="1320" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- æ»‘ç‚¹æ£€æŸ¥ A (Step 10b) -->
  <g transform="translate(950, 1330)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="50" cy="20" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="50" y="27" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">10b</text>
    
    <polygon points="150,0 250,40 150,80 70,40" fill="url(#decisionGrad)" filter="url(#shadow)"/>
    <text x="160" y="35" text-anchor="middle" fill="white" font-size="10" font-weight="bold" font-family="Arial, sans-serif">
      amountAOptimal â‰¥
    </text>
    <text x="160" y="50" text-anchor="middle" fill="white" font-size="10" font-weight="bold" font-family="Arial, sans-serif">
      amountAMin ?
    </text>
  </g>
  
  <!-- A æ»‘ç‚¹æ£€æŸ¥å¤±è´¥ -->
  <line x1="1100" y1="1410" x2="1100" y2="1550" stroke="#f45c43" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="1110" y="1500" fill="#f45c43" font-size="17" font-weight="bold" font-family="Arial, sans-serif">å¦</text>
  
  <g transform="translate(1000, 1550)">
    <rect x="0" y="0" width="170" height="45" rx="10" fill="url(#errorGrad)" filter="url(#shadow)"/>
    <text x="79" y="20" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial, sans-serif">âŒ äº¤æ˜“å›æ»š</text>
    <text x="79" y="40" text-anchor="middle" fill="white" font-size="11" font-family="Arial, sans-serif">INSUFFICIENT_A_AMOUNT</text>
  </g>
  
  <!-- A æ»‘ç‚¹æ£€æŸ¥æˆåŠŸ - Step 11b -->
  <line x1="1020" y1="1370" x2="970" y2="1370" stroke="#38ef7d" stroke-width="2"/>
  <line x1="970" y1="1370" x2="970" y2="1420" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="990" y="1400" fill="#38ef7d" font-size="10" font-weight="bold" font-family="Arial, sans-serif">æ˜¯ âœ“</text>
  
  <g transform="translate(820, 1430)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="27" r="16" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="32" text-anchor="middle" fill="white" font-size="15" font-weight="bold" font-family="Arial, sans-serif">11b</text>
    
    <rect x="20" y="0" width="200" height="55" rx="10" fill="url(#successGrad)" filter="url(#shadow)"/>
    <text x="120" y="18" text-anchor="middle" fill="white" font-size="11" font-weight="bold" font-family="Arial, sans-serif">âœ… æ–¹æ¡ˆäºŒç¡®å®š</text>
    <text x="120" y="35" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">amountA = amountAOptimal</text>
    <text x="120" y="50" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">amountB = amountBDesired</text>
  </g>
  
  <!-- ==================== æ±‡åˆåˆ°æ‰§è¡Œè½¬è´¦ ==================== -->
  <!-- ä»é¦–æ¬¡æ·»åŠ  -->
  <line x1="220" y1="1080" x2="220" y2="1530" stroke="#555" stroke-width="2"/>
  <line x1="220" y1="1530" x2="570" y2="1530" stroke="#555" stroke-width="2"/>
  
  <!-- ä»æ–¹æ¡ˆä¸€ -->
  <line x1="850" y1="1295" x2="850" y2="1340" stroke="#555" stroke-width="2"/>
  <line x1="850" y1="1340" x2="620" y2="1340" stroke="#555" stroke-width="2"/>
  <line x1="620" y1="1340" x2="620" y2="1530" stroke="#555" stroke-width="2"/>
  
  <!-- ä»æ–¹æ¡ˆäºŒ -->
  <line x1="940" y1="1485" x2="940" y2="1530" stroke="#555" stroke-width="2"/>
  <line x1="940" y1="1530" x2="670" y2="1530" stroke="#555" stroke-width="2"/>
  
  <!-- æ±‡åˆç‚¹ -->
  <circle cx="620" cy="1530" r="8" fill="#555"/>
  
  <!-- ç®­å¤´åˆ°æœ€ç»ˆæ‰§è¡Œ -->
  <line x1="620" y1="1538" x2="620" y2="1570" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- ==================== Step 11/12: æœ€ç»ˆæ‰§è¡Œæ­¥éª¤ ==================== -->
  <g transform="translate(250, 1580)">
    <!-- åºå·åœ†åœˆ -->
    <circle cx="0" cy="25" r="18" fill="url(#stepGrad)" filter="url(#shadow)"/>
    <text x="0" y="31" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial, sans-serif">11</text>
    
    <rect x="20" y="0" width="680" height="50" rx="10" fill="url(#successGrad)" filter="url(#shadow)"/>
    <text x="360" y="20" text-anchor="middle" fill="white" font-size="13" font-weight="bold" font-family="Arial, sans-serif">
      ğŸ¯ æ‰§è¡Œè½¬è´¦ä¸é“¸é€  LP Token (è¿”å› addLiquidity ä¸»å‡½æ•°)
    </text>
    <text x="360" y="40" text-anchor="middle" fill="white" font-size="10" font-family="Arial, sans-serif">
      pairFor() â†’ safeTransferFrom(tokenA/B â†’ Pair) â†’ Pair.mint(to) â†’ è¿”å› (amountA, amountB, liquidity)
    </text>
  </g>
  
  <!-- æœ€ç»ˆæ­¥éª¤è¯¦ç»†è¯´æ˜ -->
  <g transform="translate(250, 1640)">
    <rect x="0" y="0" width="700" height="50" rx="8" fill="#e8f4fd" stroke="#0288d1" stroke-width="1.5"/>
    <text x="350" y="18" text-anchor="middle" fill="#01579b" font-size="11" font-weight="bold" font-family="Arial, sans-serif">ğŸ“ æœ€ç»ˆæ‰§è¡Œè¯¦æƒ… (æºç : ç¬¬ 72-75 è¡Œ)</text>
    <text x="10" y="38" fill="#01579b" font-size="10" font-family="Arial, sans-serif">
      â‘  pairForè®¡ç®—åœ°å€ â†’ â‘¡ safeTransferFromè½¬å…¥tokenA â†’ â‘¢ safeTransferFromè½¬å…¥tokenB â†’ â‘£ Pair.minté“¸é€ LP â†’ â‘¤ è¿”å›ç»“æœ
    </text>
  </g>
  
  <!-- å›¾ä¾‹ -->
  <g transform="translate(20, 1580)">
    <rect x="0" y="0" width="200" height="90" rx="5" fill="#f0f0f0" stroke="#ccc"/>
    <text x="90" y="18" text-anchor="middle" fill="#333" font-size="11" font-weight="bold" font-family="Arial, sans-serif">å›¾ä¾‹è¯´æ˜</text>
    <circle cx="20" cy="38" r="10" fill="url(#stepGrad)"/>
    <text x="40" y="42" fill="#333" font-size="10" font-family="Arial, sans-serif">æ‰§è¡Œåºå·</text>
    <rect x="100" y="30" width="15" height="15" fill="url(#decisionGrad)"/>
    <text x="120" y="42" fill="#333" font-size="10" font-family="Arial, sans-serif">åˆ¤æ–­</text>
    <rect x="10" y="55" width="15" height="15" fill="url(#processGrad)"/>
    <text x="30" y="67" fill="#333" font-size="10" font-family="Arial, sans-serif">å¤„ç†</text>
    <rect x="80" y="55" width="15" height="15" fill="url(#successGrad)"/>
    <text x="100" y="67" fill="#333" font-size="10" font-family="Arial, sans-serif">æˆåŠŸ</text>
    <rect x="140" y="55" width="15" height="15" fill="url(#errorGrad)"/>
    <text x="160" y="67" fill="#333" font-size="10" font-family="Arial, sans-serif">é”™è¯¯</text>
  </g>
</svg>
